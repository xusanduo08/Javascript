# 依赖反转 Dependency Inversion

### 介绍

依赖关系被颠倒：高层次的模块不依赖于低层次的模块的实现细节，低层次模块依赖于高层次模块的需求抽象，依赖关系被颠倒（反转）。

### 规定

* 高层次的模块不应该依赖于低层次的模块，两者都应该依赖于抽象接口
* 抽象接口不应该依赖于具体实现细节，具体实现则应该依赖于抽象接口



传统应用架构中：

* 低层次的组件设计用于被高层次的组件使用
* 高层次的组件直接依赖于低层次的组件去实现一些任务

这种对于低层次组件的依赖限制了高层次组件被重用的可能性。

依赖反转原则基于这样一个事实：**相对于细节的多变性，抽象的东西要稳定的多。以抽象为基础搭建起来的架构比以细节为基础搭建起来的架构要稳定的多**。在java中，抽象指的是接口或抽象类，细节就是具体的实现类。使用接口或者抽象类的目的是制定好规范和契约，而不去涉及任何具体的操作，把展现细节的任务交给具体的实现类完成。

依赖反转的核心思想是**面向接口编程**。

**高层组件和低层组件模块都依赖抽象接口**。抽象接口与高层模块在同一个包。接口的实现与低层模块在同一个包。这样编译时，低层模块所在的包就依赖于高层模块所在的包。是为依赖反转。

### 目的

把高层次组件从对低层次组件的依赖中解耦出来，这样使得重用不同层级的组件实现变得可能。

### 举例

比如适配器模式。高层次的类定义了它自己适配的接口（高层次类依赖的抽象接口）。被适配对象同样依赖于适配器接口的抽象（实际是被适配对象实现了这个接口），同时它自己的实现则可以使用它自身所在低层模块的代码。

### 实现

抽象接口与高层模块在同一个包。接口的实现与底层模块在同一个包。底层组件包的编译依赖于高层组件（颠倒了传统的依赖关系）。