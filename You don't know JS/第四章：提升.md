## 你不知道的JS：作用域和闭包

## 提升

到目前为止，你应该对作用域有了一定的了解，知道变量是如何根据它们声明的位置来绑定到不同层级的作用域的。函数作用域和块级作用域都遵循着同样的规则：变量在哪个作用域声明的，它就属于哪个作用域。

但这里有个细节：在作用域的多处位置都有声明的变量绑定到作用域的行为是怎样的？接下来，我们就来讨论这个细节。

### 先有鸡还是先有蛋

经常有人认为，JavaScript中的代码是从上到下一行行执行的。这种看法只能说大体上是对的，而且这种看法会让对代码产生错误的理解：

```javascript
a = 2;
var a;
console.log(a);
```

你觉得`console.log(...)`的打印结果是什么？

许多开发者会认为结果是`undefined`，因为`var a `语句在`a = 2`后面，很自然的能想到变量被重定义了，所以变量被赋值为默认值`undefined`。但实际结果是`2`。

在看下面的代码：

```javascript
console.log(a);
var a = 2;
```

你可能觉得，之前一段代码看起来似乎有些没有按照从上到下的顺序执行，所以这段代码可能会输出`2`。也有人觉得变量`a`在声明前就使用了，所以会有一个`ReferenceError`错误抛出。

但不幸的是，这两种答案都是错的。输出结果是`undefined`。

**所以，这到底是怎么回事？**好像我们陷入了先有鸡还是先有蛋的问题，是声明在先（鸡蛋），还是赋值在先（鸡）？

