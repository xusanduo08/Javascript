进一步抽象，将上下文抽离出来

创建reduxContext.js

```jsx
//reduxContext.js
import React from 'react';

export const reduxContext = React.createContext(null);

//App.js
import {reduxContext} from './reduxContext';
class App extends Component{
    componentDidMount(){
        this.props.store.subscribe(() => this.setState(()));
    }
    
    render(){
        const state = this.props.store.getState();
        return (
        	<reduxContext.Provider value={{state, store: this.props.store}}>
        		<div>
        			<Title />
        			<Content />
        		</div>
        	</reduxContext.Provider>
        )
    }
}

//connect.js
import {reduxContext} from './reduxContext';

function connect(component){
    class Connect extends React.Component{
        render(){
            return (
            	<reduxContext.Consumer>
            		{({state}) => {
                        return React.createElement(component, state)
            		}}
            	</reduxContext.Consumer>
            )
        }
    }
}
```

这样把上下文抽离出来后，组件中调用`connect()`方法时不用再手动传入上下文了。

```jsx
// Title.js
class Title extends Component {
  render() {
    return (
      <div id='title' style={{ color: this.props.title.color }}>
      {this.props.title.text}
      </div>
    )
  }
}

export default connect(Title);

// Content.js
class Content extends Component {
  constructor() {
    super();
    this.state = {
      content: {}
    }
  }
  
  render() {
    return (
      <div id='content'>
        {this.props.content.text}
      </div>
    )
  }
}

export default connect(Content);
```

感觉`App`组件还是抽象的不行，再抽象一下：

```jsx
//创建组件Provider
import {reduxContext} from './reduxContext';

class Provider extends React.Component{
    componentDidMount(){
        this.props.store.subscribe(()=>this.setState({}));
    }
    render(){
        const state = this.props.store.getState();
        return (
        	<reduxContext.Provider value={{state}}>
                {this.props.children}
            </reduxContext.Provider>
        )
    }
}

```

`Provider`抽离出来 ，使用时只要把最外层组件包裹在`Provider`中就可以了。

```jsx
//index.js
//...
ReactDOM.render(<Provider store={store}><App /></Provider>, document.getElementById('root'))
//...
```

在使用时，只要把`store`作为`props`传给`Provider`，并用`Provider`包裹`App`就可以了，其他想订阅store的组件只要用`connect()`包裹一下就可以了。